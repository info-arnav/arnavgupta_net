{"ast":null,"code":"import { connectToDatabase } from \"../../../util/mongodb\";\nimport bcrypt from \"bcryptjs\";\nexport default (async (req, res) => {\n  if (req.method == \"POST\") {\n    bcrypt.genSalt(10, function (err, salt) {\n      bcrypt.hash(req.body.password, 10, function (err, hash) {\n        req.body.password = hash;\n      });\n    });\n    const {\n      db\n    } = await connectToDatabase();\n    let username = await db.collection(\"userData\").find({\n      username: req.body.username\n    }).limit(1).count();\n\n    if (username == 0) {\n      let email = await db.collection(\"userData\").find({\n        email: req.body.email\n      }).limit(1).count();\n\n      if (username == 0 && email == 0) {\n        let data = await db.collection(\"userData\").insertOne({\n          username: req.body.username,\n          email: req.body.email,\n          name: req.body.name,\n          password: req.body.password,\n          image: \"\",\n          images: [],\n          dateCreated: new Date(),\n          dateUpdated: new Date(),\n          profile: \"\",\n          profiles: [],\n          passwords: [],\n          usernames: [],\n          followers: [],\n          following: [],\n          bookmarked: [],\n          posts: [],\n          viewedPosts: [],\n          viewedProfiles: [],\n          tags: [],\n          viewedTypes: [],\n          liked: []\n        });\n        let finalData = await db.collection(\"userData\").find({\n          username: req.body.username\n        }).limit(1).toArray();\n        await res.status(200).json(finalData);\n      } else {\n        res.status(202).json(\"email exists\");\n      }\n    } else {\n      res.status(202).json(\"username exists\");\n    }\n  } else {\n    res.status(202).json(\"error\");\n  }\n});","map":null,"metadata":{},"sourceType":"module"}